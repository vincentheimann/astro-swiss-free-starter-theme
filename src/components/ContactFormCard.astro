---
import {
    Card,
    CardHeader,
    CardTitle,
    CardDescription,
    CardContent,
} from "@/components/starwind/card";
import { Button } from "@/components/starwind/button";
import { Input } from "@/components/starwind/input";
import { Label } from "@/components/starwind/label";
import { Textarea } from "@/components/starwind/textarea";
import { getLangFromUrl, useTranslations } from "../i18n/utils";

// Get current language and translation function
const lang = getLangFromUrl(Astro.url, Astro.currentLocale);
const t = useTranslations(lang);
---

<Card>
    <CardHeader>
        <CardTitle>{t("contact.form.title")}</CardTitle>
        <CardDescription>
            {t("contact.form.description")}
        </CardDescription>
    </CardHeader>
    <CardContent>
        <form id="contact-form" class="space-y-4">
            <div>
                <Label for="name">{t("contact.form.name")}</Label>
                <Input
                    id="name"
                    name="name"
                    type="text"
                    placeholder={t("contact.form.placeholder.name")}
                    required
                />
            </div>
            <div>
                <Label for="email">{t("contact.form.email")}</Label>
                <Input
                    id="email"
                    name="email"
                    type="email"
                    placeholder={t("contact.form.placeholder.email")}
                    required
                />
            </div>
            <div>
                <Label for="phone">{t("contact.form.phone")}</Label>
                <Input
                    id="phone"
                    name="phone"
                    type="tel"
                    placeholder={t("contact.form.placeholder.phone")}
                />
            </div>
            <div>
                <Label for="message">{t("contact.form.message")}</Label>
                <Textarea
                    id="message"
                    name="message"
                    placeholder={t("contact.form.placeholder.message")}
                    rows={4}
                    maxlength="500"
                    required
                />
                <div class="text-sm text-muted-foreground mt-1 text-right">
                    <span id="char-count">0</span> / 500
                </div>
            </div>
            <Button type="submit" class="w-full">
                {t("contact.form.submit")}
            </Button>
        </form>
    </CardContent>
</Card>

<script>
    // Character counter for message field
    const messageField = document.getElementById(
        "message",
    ) as HTMLTextAreaElement;
    const charCount = document.getElementById("char-count");

    if (messageField && charCount) {
        messageField.addEventListener("input", () => {
            charCount.textContent = messageField.value.length.toString();
        });
    }
</script>
